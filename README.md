# GeneralCode

## Organization
The repository is organized into the following components:

* *Common*: a library of low-level tools. Things in Common should only depend on low-level headers & libraries, other code in Common, but NOT on other code in this repo. 
* *Components*: useful components, to be used in other code. May depend on Common. 
* *PC-Apps*: programs that we run on PCs. Should never depend on one another, can use anything from Common or Components, or other external libraries if needed.
* *Embedded*: code relevant to running on the microcontrollers (with PX4). Has the following substructure:
  * *Apps*: "Apps" that will run on NuttX, on the PX4 stack. May depend on things in Common or Components. 
  * *LinkCMakeLists*: things that we need to link for the PX4 compilation to work.
* *Logs*: Where we store data generated by Apps, e.g. simulation logs. Nothing in here should ever be committed to the repo.
  * *Scripts*: High-level scripts, e.g. to analyze logs.

## Getting started

This is the main repository for the lab's code. Follow the below steps first:

* Clone the main repo somewhere convenient: ''git clone https://github.com/muellerlab/GeneralCode.git''
* Run the CMake Gui (to get it, run ''sudo apt install cmake-qt-gui'')
  * Specify the repo's location for the "source code", and specify a Build directory that's a subfolder to the repo location (e..g. GeneralCode/Build) for "Where to build the binaries"
  * Click Configure, then:
    * Select "Unix makefiles" and "Use default native compilers"
    * Click configure until the red items disappear
    * Click Generate
* In Eclipse, File > Import, choose "Existing Code as Makefile Project", and browse to the SOURCE folder.
* Right-click on the newly created project in the "Project Explorer", select properties:
    * Under "C/C++ Build", for "Build location", under "Builder Settings", specify the Build folder (for me: ${workspace_loc:/GeneralCode}/Build )
    * Under "C/C++ Build", for "Build location", under "Behaviour", enable parallel build. 
* Create two make targets (''all'' and ''clean'') as follows:
  * Right click on a project and select Make Target -> Create.
  * Enter the Target name and build options then click Create.
  * The make target appears on the Project Explorer.
  * Double-click on the make target ''all'' to compile the project.
* The code should now compile, but Eclipse's indexer won't recognize some symbols (making coding harder). To remedy this, do the following:
  * Go to Project properties -> C/C++ General -> Preprocessor Include Paths, Macros etc. -> tab Providers -> CDT GCC Built-in Compiler Settings
  * append -std=c++11 to Command to get compiler specs.

If you're also working on embedded code (anything that does not run on a PC, but on a vehicle), you'll need to follow the steps described in Embedded/Readme.md.

## Code style

We (arbitrarily) choose to follow the Google C++ code style. Please set this up in eclipse by going to Window > preferences, then under C/C++ > Code style > Formatter select "Import...". Browse to the Scripts folder, and then select eclipse-cpp-google-style.cml. 
